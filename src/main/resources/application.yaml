spring:
  application:
    name: lumina

  profiles:
    active: dev

  # 数据库配置
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/lumina?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&useSSL=false&allowPublicKeyRetrieval=true
    username: root
    password: Zh@123123
    hikari:
      minimum-idle: 5
      maximum-pool-size: 20
      auto-commit: true
      idle-timeout: 30000
      pool-name: DateSourceHikariCP
      max-lifetime: 1800000
      connection-timeout: 30000
      connection-test-query: SELECT 1
      leak-detection-threshold: 60000

  # Jackson 配置
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: Asia/Shanghai
    serialization:
      write-dates-as-timestamps: false
      fail-on-empty-beans: false
    deserialization:
      fail-on-unknown-properties: false
    default-property-inclusion: NON_NULL

  # HTTP Codec 配置
  http:
    codecs:
      max-in-memory-size: 100MB

  # MVC 配置
  mvc:
    async:
      request-timeout: 600000 # 10分钟

  # 服务器配置
  server:
    port: 8080
    servlet:
      context-path: /
    tomcat:
      uri-encoding: UTF-8
      max-threads: 200
      min-spare-threads: 10
      accept-count: 100
      max-connections: 8192
    max-http-header-size: 8192

  # Redis配置 (后续添加)
  data:
    redis:
      host: localhost
      port: 6379
      password:
      database: 0
      timeout: 6000ms
      lettuce:
        pool:
          max-active: 200
          max-wait: -1ms
          max-idle: 10
          min-idle: 0

  # 文件上传配置
  servlet:
    multipart:
      enabled: true
      file-size-threshold: 0
      max-file-size: 10MB
      max-request-size: 10MB

  # CORS配置
  cors:
    allowed-origins: "*"
    allowed-methods: "GET,POST,PUT,DELETE,OPTIONS"
    allowed-headers: "*"
    allow-credentials: true
    max-age: 3600

# MyBatis Plus配置
mybatis-plus:
  # 实体扫描，多个package用逗号或者分号分隔
  type-aliases-package: com.lumina.entity
  # mapper xml文件扫描路径
  mapper-locations: classpath*:mapper/*.xml
  # 以下配置均有默认值,可以不设置
  global-config:
    # 数据库相关配置
    db-config:
      # 主键类型  AUTO:"数据库ID自增" INPUT:"用户输入ID" ASSIGN_ID:"全局唯一ID (数字类型唯一ID)" ASSIGN_UUID:"全局唯一ID UUID"
      id-type: AUTO
      # 字段验证策略
      field-strategy: NOT_EMPTY
      # 逻辑删除配置
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0
    banner: false
  # 原生配置
  configuration:
    # 是否开启自动驼峰命名规则映射:从数据库列名到Java属性驼峰命名的类似映射
    map-underscore-to-camel-case: true
    # 如果查询结果中包含空值的列，则 MyBatis 在映射的时候，不会映射这个字段
    call-setters-on-nulls: true
    # 这个配置会将执行的sql打印出来，在开发或测试的时候可以用
#    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    # 缓存配置
    cache-enabled: true
    # 延迟加载
    lazy-loading-enabled: true
    # 积极延迟加载
    aggressive-lazy-loading: false

# Actuator监控配置
management:
  endpoints:
    web:
      exposure:
        include: "health,info,metrics,prometheus"
      base-path: /actuator
  endpoint:
    health:
      show-details: always
      show-components: always
  metrics:
    export:
      prometheus:
        enabled: true

# 日志配置
logging:
  level:
    com.lumina: info
    org.springframework.web: info
    org.springframework.security: info
    com.baomidou.mybatisplus: info
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/lumina.log
    max-size: 100MB
    max-history: 30

# Lumina 特定配置
lumina:
  # 认证配置
  auth:
    jwt:
      secret: lumina-jwt-secret-key-2024-secure-token-generation-for-hs512-algorithm-with-minimum-512-bits-length
      expiration: 86400000  # 24小时，毫秒
      refresh-expiration: 604800000  # 7天，毫秒

  # API配置
  api:
    version: v1
    prefix: /api/v1